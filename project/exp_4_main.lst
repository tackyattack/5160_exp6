C51 COMPILER V6.02  EXP_4_MAIN                                                             11/21/2019 13:16:06 PAGE 1   


C51 COMPILER V6.02, COMPILATION OF MODULE EXP_4_MAIN
OBJECT MODULE PLACED IN .\exp_4_main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\source\exp_4_main.c LARGE DEBUG OBJECTEXTEND PRINT(.\exp_4_main.lst) OBJ
                    -ECT(.\exp_4_main.obj) 

stmt level    source

   1          #include <stdio.h>
   2          #include "main.h"
   3          #include "PORT.H"
   4          #include "Directory_Functions_struct.h"
   5          #include "file_system.h"
   6          #include "LED_Control.h"
   7          #include "SPI.h"
   8          #include "SDCard.h"
   9          #include "print_bytes.h"
  10          #include "Timer0_hardware_delay_1ms.h"
  11          #include "UART.h"
  12          #include "LCD_Routines.h"
  13          //#include "Long_Serial_In.h"
  14          #include "Outputs.h"
  15          #include "player.h"
  16          #include "STA013_config.h"
  17          #include "I2C.h"
  18          #include "sEOS.h"
  19          
  20          xdata uint8_t buf1[512];
  21          xdata uint8_t buf2[512];
  22          uint8_t code LCD_str_start[]="Starting...";
  23          
  24          main()
  25          {
  26   1         uint8_t error_flag;
  27   1      
  28   1         AUXR=0x0c;   // make all of XRAM available, ALE always on
  29   1         if(OSC_PER_INST==6)
  30   1         {
  31   2             CKCON0=0x01;  // set X2 clock mode
  32   2         }
  33   1         else if(OSC_PER_INST==12)
  34   1         {
  35   2             CKCON0=0x00;  // set standard clock mode
  36   2         }
  37   1      
  38   1         LEDS_ON(Red_LED);
  39   1         P2_set_bit(0x0F);
  40   1      
  41   1         Timer0_DELAY_1ms(300);
  42   1         uart_init(9600);
  43   1      
  44   1         if(STA013_init() != no_errors) while(1);
  45   1      
  46   1         LCD_Init();
  47   1         LCD_Print(0x00, sizeof(LCD_str_start)-1, LCD_str_start);
  48   1         printf("starting program...\n");
  49   1      
  50   1         // My SD card won't init at 400kHz, so using 200kHz
  51   1         error_flag=SPI_Master_Init(200000UL);
  52   1         if(error_flag!=no_errors)
  53   1         {
  54   2            LEDS_ON(Red_LED);  // An error causes the program to stop
C51 COMPILER V6.02  EXP_4_MAIN                                                             11/21/2019 13:16:06 PAGE 2   

  55   2      	    UART_Transmit('S');
  56   2            while(1);
  57   2         }
  58   1         LEDS_ON(Amber_LED);
  59   1         // SD Card Initialization
  60   1         error_flag=SD_card_init();
  61   1         if(error_flag!=no_errors)
  62   1         {
  63   2            LEDS_ON(Red_LED);  // An error causes the program to stop
  64   2      	  UART_Transmit('C');
  65   2            while(1);
  66   2         }
  67   1         LEDS_OFF(Amber_LED);
  68   1         error_flag=SPI_Master_Init(20000000UL);
  69   1         if(error_flag!=no_errors)
  70   1         {
  71   2            LEDS_ON(Red_LED);  // An error causes the program to stop
  72   2      	    UART_Transmit('P');
  73   2            while(1);
  74   2         }
  75   1      
  76   1         printf("Mounting SD card\n");
  77   1         if(mount_drive(buf1) == MOUNT_SUCCESS)
  78   1         {
  79   2           printf("SD card mounted\n");
  80   2           LEDS_OFF(Red_LED);
  81   2           LEDS_ON(Green_LED);
  82   2         }
  83   1         else
  84   1         {
  85   2           printf("SD card failed to mount\n");
  86   2           while(1);
  87   2         }
  88   1      
  89   1         sEOS_init(12);
  90   1         while(1);
  91   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    213    ----
   CONSTANT SIZE    =     93    ----
   XDATA SIZE       =   1024       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
